"""
# Update existing records and insert new ones based on a condition defined by the column: ID
    
deltaTable = DeltaTable.forPath(spark, delta_table_path)    

dfUpdates = df
    
deltaTable.alias('silver') \
  .merge(
    dfUpdates.alias('updates'),
    'silver.ID = updates.ID'
  ) \
   .whenMatchedUpdate(set =
    {
      "ID": "updates.ID",
      "Year": "updates.Year",
      "Town": "updates.Town",
      "Type of Vehicle Registration": "updates.Type of Vehicle Registration",
      "Type of Fuel": "updates.Type of Fuel",
      "No. of Licensed Vehicles": "updates.No. of Licensed Vehicles"
    }
  ) \
 .whenNotMatchedInsert(values =
    {
      "Date": "updates.Date",
      "Time": "updates.Time",
      "Temperature_celsius": "updates.Temperature_celsius",
      "PreviousTemperature": "updates.PreviousTemperature",
      "WindDirection": "updates.WindDirection",
      "WindSpeed_mps": "updates.WindSpeed_mps",
      "PreviousWindSpeed": "updates.PreviousWindSpeed",
      "WindGust_mps": "updates.WindGust_mps"
    }
  ) \
  .execute()
  """